(()=>{"use strict";const n={en:"English",es:"Spanish",fr:"French",de:"German",it:"Italian",pt:"Portuguese",ru:"Russian",ja:"Japanese",ko:"Korean",zh:"Chinese",ar:"Arabic",hi:"Hindi",tr:"Turkish",af:"Afrikaans",sq:"Albanian",am:"Amharic",hy:"Armenian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",bg:"Bulgarian",ca:"Catalan",ceb:"Cebuano",co:"Corsican",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",eo:"Esperanto",et:"Estonian",fi:"Finnish",fy:"Frisian",gl:"Galician",ka:"Georgian",el:"Greek",gu:"Gujarati",ht:"Haitian Creole",ha:"Hausa",haw:"Hawaiian",he:"Hebrew",hmn:"Hmong",hu:"Hungarian",is:"Icelandic",ig:"Igbo",id:"Indonesian",ga:"Irish",jv:"Javanese",kn:"Kannada",kk:"Kazakh",km:"Khmer",rw:"Kinyarwanda",ku:"Kurdish",ky:"Kyrgyz",lo:"Lao",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"Macedonian",mg:"Malagasy",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mn:"Mongolian",my:"Myanmar (Burmese)",ne:"Nepali",no:"Norwegian",ny:"Nyanja (Chichewa)",or:"Odia (Oriya)",ps:"Pashto",fa:"Persian",pl:"Polish",pa:"Punjabi",ro:"Romanian",sm:"Samoan",gd:"Scots Gaelic",sr:"Serbian",st:"Sesotho",sn:"Shona",sd:"Sindhi",si:"Sinhala",sk:"Slovak",sl:"Slovenian",so:"Somali",su:"Sundanese",sw:"Swahili",sv:"Swedish",tl:"Tagalog (Filipino)",tg:"Tajik",ta:"Tamil",tt:"Tatar",te:"Telugu",th:"Thai",tk:"Turkmen",uk:"Ukrainian",ur:"Urdu",ug:"Uyghur",uz:"Uzbek",vi:"Vietnamese",cy:"Welsh",xh:"Xhosa",yi:"Yiddish",yo:"Yoruba",zu:"Zulu"};function e(){return new Promise((n=>{chrome.storage.sync.get(["spotifyLyricsTranslationLang"],(e=>{n(e.spotifyLyricsTranslationLang||"en")}))}))}let t=!1;async function a(){if(t)return;t=!0;const n=await e(),a=document.querySelectorAll('[data-testid="fullscreen-lyric"] div');document.querySelectorAll('[data-translated="true"]').forEach((n=>n.remove()));const i=[];a.forEach(((n,e)=>{const t=n.textContent.trim();t&&"♪"!==t&&i.push({index:e,text:t})}));const o=await Promise.all(i.map((async e=>{const t=await async function(n,e){const t=`https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=${e}&dt=t&q=${encodeURIComponent(n)}`;try{const n=await fetch(t);return(await n.json())[0][0][0]}catch(n){return console.error("Translation failed:",n),"[Translation Error]"}}(e.text,n);return{index:e.index,translatedText:t}})));o.forEach((({index:n,translatedText:e})=>{const t=a[n],i=document.createElement("div");i.style.color="gray",i.style.fontStyle="italic",i.textContent=e,i.setAttribute("data-translated","true"),t.parentNode.insertBefore(i,t.nextSibling)})),t=!1}function i(){document.querySelector(".main-view-container__scroll-node-child")?(o(),setInterval((()=>{document.querySelector('[data-translated="true"]')||t||a()}),2e3)):setTimeout(i,1e3)}function o(){document.querySelector('[data-testid="fullscreen-lyric"]')?(function(){const t=document.createElement("div");t.style.cssText="\n        position: sticky;\n        top: 0;\n        z-index: 1000;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        padding: 12px 0;\n        background: rgba(40, 40, 40, 0.95);\n        width: 100%;\n        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n        margin: 0;\n    ";const a=document.createElement("div");a.style.cssText="\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        gap: 8px;\n        max-width: 600px;\n        width: 90%;\n    ";const i=document.createElement("span");i.textContent="🌏",i.style.cssText="\n        font-size: 16px;\n        color: white;\n    ",a.appendChild(i),a.appendChild(function(){const t=document.createElement("div");t.classList.add("language-select"),t.style.cssText="\n        position: relative;\n        flex: 0 1 200px;\n        min-width: 120px;\n    ";const a=document.createElement("button");a.style.cssText="\n        width: 100%;\n        padding: 8px;\n        border: none;\n        border-radius: 4px;\n        background: rgba(80, 80, 80, 1);\n        color: white;\n        font-size: 14px;\n        text-align: left;\n        cursor: pointer;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n    ";const i=function(){const e=document.createElement("div");e.classList.add("dropdown"),e.style.cssText="\n        display: none;\n        position: absolute;\n        top: 100%;\n        left: 0;\n        right: 0;\n        background: rgba(40, 40, 40, 0.98);\n        border-radius: 4px;\n        margin-top: 4px;\n        max-height: 300px;\n        overflow-y: auto;\n        z-index: 1000;\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    ";const t=function(){const n=document.createElement("input");return n.style.cssText="\n        width: calc(100% - 16px);\n        margin: 8px;\n        padding: 8px;\n        border: none;\n        border-radius: 4px;\n        background: rgba(255, 255, 255, 0.1);\n        color: white;\n        font-size: 14px;\n    ",n.placeholder="Search language...",n}(),a=document.createElement("div");function i(e=""){a.innerHTML="";const t=["en","tr","pl","es","fr","de","pt","ja","it","nl"],i=Object.entries(n).filter((([n,t])=>t.toLowerCase().includes(e.toLowerCase()))),o=i.filter((([n])=>t.includes(n))).sort(((n,e)=>t.indexOf(n[0])-t.indexOf(e[0]))),r=i.filter((([n])=>!t.includes(n))).sort(((n,e)=>n[1].localeCompare(e[1])));if(o.length>0&&r.length>0){const n=document.createElement("div");n.style.cssText="\n                padding: 8px 16px;\n                color: #888;\n                font-size: 12px;\n                text-transform: uppercase;\n                letter-spacing: 1px;\n            ",n.textContent="Other Languages",[...o,n,...r].forEach((n=>{if(n instanceof HTMLElement)return void a.appendChild(n);const[e,t]=n,i=document.createElement("div");i.style.cssText="\n                    padding: 8px 16px;\n                    cursor: pointer;\n                    color: white;\n                    transition: background-color 0.2s;\n                ",i.textContent=t,i.addEventListener("mouseover",(()=>{i.style.backgroundColor="rgba(255, 255, 255, 0.1)"})),i.addEventListener("mouseout",(()=>{i.style.backgroundColor="transparent"})),i.addEventListener("click",(async()=>{var n;await(n=e,chrome.storage.sync.set({spotifyLyricsTranslationLang:n})),i.closest(".language-select").querySelector("button").textContent=t,i.closest(".dropdown").style.display="none",document.querySelectorAll('[data-translated="true"]').forEach((n=>n.remove())),window.translateLyrics()})),a.appendChild(i)}))}}return a.style.cssText="\n        padding: 8px 0;\n    ",t.addEventListener("input",(n=>{i(n.target.value)})),i(),e.appendChild(t),e.appendChild(a),e}();return e().then((e=>{a.textContent=n[e]})),a.addEventListener("click",(()=>{i.style.display="none"===i.style.display?"block":"none","block"===i.style.display&&i.querySelector("input").focus()})),document.addEventListener("click",(n=>{t.contains(n.target)||(i.style.display="none")})),t.appendChild(a),t.appendChild(i),t}()),t.appendChild(a);const o=document.querySelector(".main-view-container__scroll-node-child");o&&o.insertBefore(t,o.firstChild)}(),function(){const n=document.querySelector('[data-testid="fullscreen-lyric"]');n&&new MutationObserver((()=>{a()})).observe(n,{childList:!0,subtree:!0})}(),a()):setTimeout(o,1e3)}!async function(){i()}(),window.translateLyrics=a})();